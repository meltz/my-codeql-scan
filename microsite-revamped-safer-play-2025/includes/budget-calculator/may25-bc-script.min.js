const app=Vue.createApp({data:()=>({showStart:!0,showResult:!1,errorMsgEN:"Please enter whole numbers only",errorMsgCH:"只限填写整数",employmentIncomeError:"",otherIncomeError:"",foodExpenseError:"",transportExpenseError:"",housingExpenseError:"",othersExpenseError:"",entertainmentExpenseError:"",gamblingExpenseError:"",othersLeisureExpenseError:"",submitButtonError:"",employmentIncome:null,otherIncome:null,foodExpense:null,transportExpense:null,housingExpense:null,othersExpense:null,entertainmentExpense:null,gamblingExpense:null,othersLeisureExpense:null,totalIncome:0,totalExpenses:0,totalLeisureExpenses:0,gamblingOverIncomeP:0,chartReminderP:0,balanceLeft:0,result:"",chartColor:"",chart:null}),methods:{onlyAllowNumbers(e){/[0-9]/.test(e.key)||e.preventDefault()},filterNumericInput(e){this[e]=String(this[e]).replace(/\D/g,"")},validateNumeric(e){""!==this[e]&&/^[0-9]+$/.test(this[e])?this[e+"Error"]=!1:this[e+"Error"]=!0,this.disabledButton()},disabledButton(){!1===this.employmentIncomeError&&!1===this.otherIncomeError&&!1===this.foodExpenseError&&!1===this.transportExpenseError&&!1===this.housingExpenseError&&!1===this.othersExpenseError&&!1===this.entertainmentExpenseError&&!1===this.gamblingExpenseError&&!1===this.othersLeisureExpenseError?this.submitButtonError=!1:this.submitButtonError=!0},submitForm(e){!1===this.submitButtonError&&!1===this.employmentIncomeError&&!1===this.otherIncomeError&&!1===this.foodExpenseError&&!1===this.transportExpenseError&&!1===this.housingExpenseError&&!1===this.othersExpenseError&&!1===this.entertainmentExpenseError&&!1===this.gamblingExpenseError&&!1===this.othersLeisureExpenseError&&(this.countBalanceLeft(),this.$nextTick((()=>{this.updateChart(),document.getElementById("result-section")?.scrollIntoView({behavior:"smooth"})})),this.trackVirtualPage(e,"budget-calculator-result"))},countBalanceLeft(){this.showStart=!1,this.showResult=!0,this.balanceLeft=this.totalIncome-this.totalExpenses-this.totalLeisureExpenses,this.gamblingOverIncomeP=this.totalIncome>0?Math.max(0,Math.min(Math.round(this.gamblingExpense/this.totalIncome*100),100)):0,this.chartReminderP=Math.max(0,Math.round(100*(100-this.gamblingOverIncomeP))/100),0!==parseInt(this.gamblingExpense)?this.balanceLeft>0?(this.result="positive",this.chartColor="#f4b900"):0===this.balanceLeft?(this.result="equal",this.chartColor="#e58613"):this.balanceLeft<0&&(this.result="negative",this.chartColor="#d94538"):(this.result="very-positive",this.chartColor="#f4b900"),this.trackResult(this.balanceLeft,this.result)},updateChart(){this.$nextTick((()=>{const e=document.getElementById("balanceLeftChart");if(!e)return;const t=e.getContext("2d");this.chart&&this.chart.destroy(),this.chart=new Chart(t,{type:"doughnut",data:{labels:["Gambling Expense","Total Income"],datasets:[{data:[this.gamblingOverIncomeP,this.chartReminderP],backgroundColor:[this.chartColor,"#0073C2"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>`${e.raw}%`}}}}})}))},resetFields(){this.employmentIncomeError="",this.otherIncomeError="",this.foodExpenseError="",this.transportExpenseError="",this.housingExpenseError="",this.othersExpenseError="",this.entertainmentExpenseError="",this.gamblingExpenseError="",this.othersLeisureExpenseError="",this.submitButtonError="",this.employmentIncome=null,this.otherIncome=null,this.foodExpense=null,this.transportExpense=null,this.housingExpense=null,this.othersExpense=null,this.entertainmentExpense=null,this.gamblingExpense=null,this.othersLeisureExpense=null,this.totalIncome=0,this.totalExpenses=0,this.totalLeisureExpenses=0,this.gamblingOverIncomeP=0,this.chartReminderP=0,this.balanceLeft=0,this.result="",this.chartColor="",this.showResult=!1,window.scrollTo(0,0),this.$nextTick((()=>{document.getElementById("app")?.scrollIntoView({behavior:"smooth"})}))},trackVirtualPage(e,t){const s=`/ms/sp/${e}/${t}.html`;dataLayer.push({event:"bc_virtual_page_view",event_category:"bc_virtual_page_view",event_action:t,event_label:s})},trackResult(e,t){dataLayer.push({event:"bc_result",event_category:"Budget Calculator Result",event_action:e,event_label:t})},trackOutbound(e){const t=e.target.getAttribute("href");dataLayer.push({event:"bc_outbound",event_category:"Calculator Outbound",event_action:"Click",event_label:t})}},computed:{getTotalIncome(){return this.totalIncome=parseInt(this.employmentIncome||0)+parseInt(this.otherIncome||0),this.totalIncome},getTotalExpenses(){return this.totalExpenses=parseInt(this.foodExpense||0)+parseInt(this.transportExpense||0)+parseInt(this.housingExpense||0)+parseInt(this.othersExpense||0),this.totalExpenses},getTotalLeisureExpenses(){return this.totalLeisureExpenses=parseInt(this.entertainmentExpense||0)+parseInt(this.gamblingExpense||0)+parseInt(this.othersLeisureExpense||0),this.totalLeisureExpenses}}});app.mount("#app");